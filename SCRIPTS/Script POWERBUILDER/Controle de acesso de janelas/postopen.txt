int	 li_usr_id, li_tot, li_ind
string ls_nm_app, ls_usr_id, ls_sql, ls_nm_window
string ls_cd_controle, ls_ds_controle, ls_st_acesso 

// preenchendo o dropdown tipo de relatorio
ls_nm_window = this.classname()


ls_nm_app = gnv_app.iapp_object.appname


ls_usr_id = gnv_app.of_GetUserId()

ls_sql =  "select security_template.control, security_template.description" +&
			  "  from security_template" + &
			  " where ( security_template.application = '" + ls_nm_app +"' ) and  " + &
			  "       ( security_template.window = '" + ls_nm_window +"') "


declare crs_sec dynamic cursor for SQLSA ;

prepare SQLSA from :ls_sql ;

open dynamic crs_sec;

fetch crs_sec into :ls_cd_controle, :ls_ds_controle;

li_ind = 0

do while SQLCA.SQLCode = 0
	li_ind ++

	
	ls_st_acesso = gnv_app.inv_security.of_GetPermissionsMenu(ls_nm_window, ls_cd_controle)
	
	ls_ds_controle = trim(ls_ds_controle)
	ls_ds_controle += space(200 - len(ls_ds_controle))
	ls_ds_controle += left(ls_st_acesso, 1)
	
	if left(ls_st_acesso, 1) = '1' or left(ls_st_acesso, 1) = '3' then
		li_tot = ddlb_tp_int.AddItem(ls_ds_controle)
		
	end if	

	fetch crs_sec into :ls_cd_controle, :ls_ds_controle;
loop

close crs_sec;

if ddlb_tp_int.totalitems() = 1 then
	ddlb_tp_int.SelectItem(1)
	ddlb_tp_int.Event SelectionChanged(1)
end if	


ddlb_tp_int.SetFocus()